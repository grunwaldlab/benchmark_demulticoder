library('ggtree')
library('phytools')
library('ape')
library('rhierbaps')
library('ggnewscale')
library('dendextend')

tr1<-read.tree("~/Desktop/cox1.ml.treefile")
tr2<-read.tree("~/Desktop/rps10.ml.treefile")
all.equal.phylo(tr1,tr2)

tr3<-read.tree("~/Desktop/cox1_nj.newick")
tr4<-read.tree("~/Desktop/rps10_nj.newick")
all.equal.phylo(tr3,tr4)

#pruned trees without flagged 

cPhylo <- read.tree(file = "~/Desktop/cox1.ml.treefile")
dendrogram_mlcox1<- denlist(cPhylo)

cPhylo2 <- read.tree(file = "~/Desktop/rps10.ml.treefile")
dendrogram_mlrps10<- chronos(cPhylo2)



tr2$edge.length
tr2$edge.length[is.nan(tr2$edge.length)]<-FALSE
tr2$edge.length


assoc=read.csv("~/Desktop/assoc.csv", header=TRUE)
assoc$cox1 <- gsub('\\s+', '', assoc$cox1)
assoc$cox1

pdf("Figure_frank.pdf",height=120,width=80,useDingbats=FALSE)
a=cophylo(tr1, tr2, rotate=TRUE, assoc = assoc)
plot(a)
# S3 method for cophylo
dev.off()

#import trees
pdf("Figure_ML_rotateno.pdf",height=120,width=80,useDingbats=FALSE)
a=cophylo(tr3, tr4)
plot(a)
# S3 method for cophylo
dev.off()



#ML trees
pdf("Figure_frank.pdf",height=80,width=40,useDingbats=FALSE)
a=cophylo(tr3, tr4, rotate=TRUE, edge.col=edge.col,lwd=2)
summary(a)
plot(a)
# S3 method for cophylo
dev.off()

###################
data(wasp.trees)
data(wasp.data)
wasp.data
## create co-phylogenetic object
wasp.cophylo<-cophylo(wasp.trees[[1]],wasp.trees[[2]],
                      assoc=wasp.data)
## plot co-phylogenies
pdf("Figure_test.pdf",height=80,width=40,useDingbats=FALSE)
plot(wasp.cophylo,link.type="curved",link.lwd=4,
     link.lty="solid",link.col=make.transparent("red",
                                                0.25))
par(mar=c(5.1,4.1,4.1,2.1))
dev.off()
###################################################
#distance matrices
# Custom these kendo, and place them in a list
dl <- dendlist(
  dendrogram_mlcox1 %>% 
    set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
    set("branches_lty", 1) %>%
    set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3),
  dendrogram_mlrps10 %>% 
    set("labels_col", value = c("skyblue", "orange", "grey"), k=3) %>%
    set("branches_lty", 1) %>%
    set("branches_k_color", value = c("skyblue", "orange", "grey"), k = 3)
)

# Plot them together

dl <- dendlist(dendrogram_mlcox1,dendrogram_mlrps10)
tanglegram(tr3, 
           common_subtrees_color_lines = FALSE, highlight_distinct_edges  = TRUE, highlight_branches_lwd=FALSE, 
           margin_inner=7,
           lwd=2
)

###################################################
#Cophylo analysis of new trees generated by Sam for primer design
